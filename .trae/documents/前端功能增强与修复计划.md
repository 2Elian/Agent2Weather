# 1. 局域网访问支持
- **目标**：允许同一局域网下的设备访问前端页面。
- **文件**：`web/vite.config.js`
- **操作**：
  - 在 `server` 配置中添加 `host: '0.0.0.0'`。
  - 这将使 Vite 服务器监听所有网络接口，而不仅仅是本地回环地址。

# 2. Metadata 详细执行过程展示
- **目标**：在结果详情抽屉中展示 AI 的完整思考与执行链路。
- **文件**：`web/src/components/MetadataDrawer.jsx`
- **操作**：
  - 重构抽屉内容结构，使用 `Collapse` 折叠面板区分不同阶段：**摘要 (Summary)**、**前期实况 (History)**、**天气预报 (Forecast)**、**关注建议 (Suggestion)**。
  - 为每个阶段添加详细字段展示：
    - `recall_template`: 召回的 Prompt 模板（代码块展示）。
    - `sql_data`: 数据库查询结果（仅 Forecast 阶段，表格展示）。
    - `think_response`: 模型思考过程（Markdown 渲染）。
    - `response`: 最终输出内容（Markdown 渲染）。
  - 优化数据展示样式，增加可读性。

# 3. PDF 导出功能优化
- **目标**：解决 PDF 导出时的截断和分页问题，确保长文档格式正确。
- **文件**：`web/src/App.jsx`
- **操作**：
  - **多页支持**：重写 `handleExportPdf` 逻辑。
    - 计算生成图片的高度。
    - 如果图片高度超过 A4 纸一页的高度，自动进行图片切分并添加新页面 (`pdf.addPage()`)。
  - **渲染优化**：
    - 确保截图时的 DOM 容器具有固定的 A4 宽度（约 794px），保证文字换行与打印一致。
    - 提高 `html2canvas` 的 `scale` 参数以保证清晰度。
    - 优化背景色渲染配置。
